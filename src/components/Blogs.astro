---
import { getCollection } from 'astro:content';
import ArticleCard from './ArticleCard.astro';

// Get all blog posts and sort by date (newest first)
const allBlogs = await getCollection('blog');
const sortedBlogs = allBlogs.sort(
  (a, b) => b.data.dateCreated.getTime() - a.data.dateCreated.getTime()
);

// Get only the first 6 blogs
const recentBlogs = sortedBlogs.slice(0, 6);
---

<section class='py-20 px-4' id='blogs'>
  <div class='container-fluid'>
    <div
      class='mb-12 flex flex-col md:flex-row md:items-center md:justify-between gap-4'
    >
      <div>
        <h2 class='text-3xl md:text-4xl font-bold mb-4 first-letter-color'>
          Latest Articles
        </h2>
        <p class='text-muted-foreground text-lg'>
          Thoughts on software development, technology, and personal growth
        </p>
      </div>
      <a
        href='/blog'
        class='inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors font-medium whitespace-nowrap self-start md:self-center'
      >
        View All Articles
        <svg
          xmlns='http://www.w3.org/2000/svg'
          class='h-5 w-5'
          fill='none'
          viewBox='0 0 24 24'
          stroke='currentColor'
        >
          <path
            stroke-linecap='round'
            stroke-linejoin='round'
            stroke-width='2'
            d='M13 7l5 5m0 0l-5 5m5-5H6'></path>
        </svg>
      </a>
    </div>

    <div class='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6'>
      {
        recentBlogs.map((blog) => (
          <ArticleCard
            title={blog.data.title}
            description={blog.data.description}
            dateCreated={blog.data.dateCreated}
            tags={blog.data.tags}
            slug={blog.slug}
            cover_image={blog.data.cover_image}
          />
        ))
      }
    </div>
  </div>
</section>
