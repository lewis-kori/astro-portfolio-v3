---
import Layout from '@/layouts/Layout.astro';
import { getCollection } from 'astro:content';
import SectionHeader from '@/components/shared/SectionHeader.astro';
import ResourceItem from '@/components/shared/ResourceItem.astro';

const sponsors = await getCollection('sponsors');
const currentBooks = await getCollection('books');
const techStack = await getCollection('techStack');
const desktopSetup = await getCollection('desktopSetup');
---

<Layout
  title='Resources | Lewis Kori'
  description='Tools, books, and resources I use for software development'
>
  <div class='relative'>
    <div class='container-fluid py-16 md:py-20 relative'>
      <div class='mb-20 text-center space-y-6'>
        <div class='inline-block'>
          <span
            class='text-xs uppercase tracking-widest text-primary font-bold px-4 py-2 rounded-full bg-primary/10 border border-primary/20 backdrop-blur-sm'
          >
            My Arsenal
          </span>
        </div>
        <h1
          class='text-3xl md:text-4xl font-semibold text-foreground leading-tight tracking-tight first-letter-color'
        >
          Tools & Resources<br />
          <span class='text-secondary'>I Use Daily</span>
        </h1>
        <p
          class='text-lg md:text-xl text-muted-foreground font-light max-w-3xl mx-auto leading-relaxed'
        >
          A peek into the books, tech, and gear that fuel my work and keep me
          productive
        </p>
      </div>

      <section class='mb-32'>
        <SectionHeader
          title='Current Reading'
          subtitle='Expanding my mind one page at a time'
        />
        <div class='grid md:grid-cols-2 gap-6 md:gap-12'>
          {
            currentBooks.map((book, index) => (
              <ResourceItem
                href={book.data.link}
                image={book.data.image}
                title={book.data.title}
                subtitle={book.data.author}
                description={book.data.description}
                linkText='View book'
                imageSize='book'
                index={index}
              />
            ))
          }
        </div>
      </section>

      <section class='mb-32'>
        <SectionHeader
          title='Tech Stack'
          subtitle='The tools I rely on for building software'
          accentColor='secondary'
        />
        <div class='grid md:grid-cols-2 gap-6 md:gap-12'>
          {
            techStack.map((tech, index) => (
              <ResourceItem
                href={tech.data.link}
                image={tech.data.image}
                title={tech.data.name}
                description={tech.data.description}
                linkText='Learn more'
                imageSize='small'
                index={index}
                target='_blank'
                rel='noopener noreferrer'
              />
            ))
          }
        </div>
      </section>

      <section class='mb-32'>
        <SectionHeader
          title='My Setup'
          subtitle='The gear that powers my daily workflow'
        />
        <div class='grid md:grid-cols-2 gap-6 md:gap-12'>
          {
            desktopSetup.map((item, index) => (
              <ResourceItem
                href={item.data.link}
                image={item.data.image}
                title={item.data.name}
                description={item.data.description}
                linkText='Buy here'
                imageSize='medium'
                index={index}
              />
            ))
          }
        </div>
      </section>

      <section class='mb-16'>
        <SectionHeader
          title='Sponsors'
          subtitle='The partners who make my content possible'
          accentColor='secondary'
        />
        <div class='grid md:grid-cols-2 gap-6'>
          {
            sponsors.map(async (sponsor, index) => {
              const { Content } = await sponsor.render();
              return (
                <div
                  class='group flex gap-6 md:p-8 transition-all duration-300'
                  style={`animation-delay: ${index * 100}ms`}
                >
                  <div class='relative shrink-0'>
                    <div class='relative w-16 h-16 flex items-center justify-center rounded-xl p-2'>
                      <img
                        src={
                          sponsor.data.logo ||
                          `https://logo.clearbit.com/${new URL(sponsor.data.url).hostname}`
                        }
                        alt={sponsor.data.name}
                        class='w-full h-full object-contain'
                        onerror={`this.src='https://logo.clearbit.com/${new URL(sponsor.data.url).hostname}'`}
                      />
                    </div>
                  </div>
                  <div class='flex flex-col space-y-4 min-w-0'>
                    <div class='space-y-2'>
                      <h3 class='text-2xl font-bold text-foreground group-hover:text-primary transition-colors'>
                        {sponsor.data.name}
                      </h3>
                      <a
                        href={sponsor.data.url}
                        target='_blank'
                        rel='noopener noreferrer'
                        class='inline-flex items-center gap-2 text-sm font-semibold text-primary hover:gap-3 transition-all'
                      >
                        <span>Visit Website</span>
                        <svg
                          class='w-4 h-4'
                          fill='none'
                          viewBox='0 0 24 24'
                          stroke='currentColor'
                        >
                          <path
                            stroke-linecap='round'
                            stroke-linejoin='round'
                            stroke-width='2'
                            d='M17 8l4 4m0 0l-4 4m4-4H3'
                          />
                        </svg>
                      </a>
                    </div>
                    <div class='prose prose-sm max-w-none [&_p]:text-muted-foreground [&_p]:leading-relaxed [&_p]:mb-3 [&_a]:text-primary [&_a]:font-semibold [&_a]:no-underline hover:[&_a]:underline [&_strong]:text-foreground [&_strong]:font-bold [&_img]:hidden'>
                      <Content />
                    </div>
                  </div>
                </div>
              );
            })
          }
        </div>
      </section>
    </div>
  </div>
</Layout>
